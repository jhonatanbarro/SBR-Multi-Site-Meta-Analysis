theme_light()+
facet_wrap(~year)+
coord_map(xlim=-c(57.5, 43.5), ylim=-c(34,10.5))+
theme(legend.position = "right", strip.text = element_text(face="bold", size=16),text = element_text(size=16))+
#guides(shape=FALSE)+
labs(x = "Longitude", y = "Latitude", size ="Severity at R6 \n stage (%)", color = "Harvest year")+
#ggtitle("Local dos ensaios")+
ggsave("figs/mapa_brazil5.png", width=13, height=8)
map <- ggplot(dat_local)+ geom_polygon(data = brazil_map2,
aes(x=long, y=lat, group=group), fill = "grey96", color ="grey50")+
geom_jitter(alpha= 1/2, width=0.5, height=0.3, data = dat_local, aes (x = lon, y = lat, size = check_sev_r6))+
coord_fixed()+
scale_shape_manual(values = c(17,16))+
theme_light()+
facet_wrap(~year, ncol = 4)+
coord_map(xlim=-c(57.5, 43.5), ylim=-c(34,10.5))+
theme(legend.position = "top", strip.text = element_text(face="bold", size=16),text = element_text(size=16))+
#guides(shape=FALSE)+
labs(x = "Longitude", y = "Latitude", size ="Severity at R6 \n stage (%)", color = "Harvest year")+
#ggtitle("Local dos ensaios")+
ggsave("figs/mapa_brazil5.png", width=13, height=8)
map <- ggplot(dat_local)+ geom_polygon(data = brazil_map2,
aes(x=long, y=lat, group=group), fill = "grey96", color ="grey50")+
geom_jitter(alpha= 1/2, width=0.5, height=0.3, data = dat_local, aes (x = lon, y = lat, size = check_sev_r6))+
coord_fixed()+
scale_shape_manual(values = c(17,16))+
theme_light()+
facet_wrap(~year, ncol = 4)+
#coord_map(xlim=-c(57.5, 43.5), ylim=-c(34,10.5))+
theme(legend.position = "top", strip.text = element_text(face="bold", size=16),text = element_text(size=16))+
#guides(shape=FALSE)+
labs(x = "Longitude", y = "Latitude", size ="Severity at R6 stage (%)", color = "Harvest year")+
#ggtitle("Local dos ensaios")+
ggsave("figs/mapa_brazil4.png", width=13, height=8)
map <- ggplot(dat_local)+ geom_polygon(data = brazil_map2,
aes(x=long, y=lat, group=group), fill = "grey96", color ="grey50")+
geom_jitter(alpha= 1/2, width=0.5, height=0.3, data = dat_local, aes (x = lon, y = lat, size = check_sev_r6))+
coord_fixed()+
scale_shape_manual(values = c(17,16))+
theme_light()+
facet_wrap(~year, ncol = 4)+
coord_map(xlim=-c(57.5, 43.5), ylim=-c(34,10.5))+
theme(legend.position = "top", strip.text = element_text(face="bold", size=16),text = element_text(size=16))+
#guides(shape=FALSE)+
labs(x = "Longitude", y = "Latitude", size ="Severity at R6 stage (%)", color = "Harvest year")+
#ggtitle("Local dos ensaios")+
ggsave("figs/mapa_brazil4.png", width=13, height=8)
map <- ggplot(dat_local)+ geom_polygon(data = brazil_map2,
aes(x=long, y=lat, group=group),  color ="grey50")+
geom_jitter(alpha= 1/2, width=0.5, height=0.3, data = dat_local, aes (x = lon, y = lat, size = check_sev_r6))+
coord_fixed()+
scale_shape_manual(values = c(17,16))+
theme_light()+
facet_wrap(~year, ncol = 4)+
coord_map(xlim=-c(57.5, 43.5), ylim=-c(34,10.5))+
theme(legend.position = "top", strip.text = element_text(face="bold", size=16),text = element_text(size=16))+
#guides(shape=FALSE)+
labs(x = "Longitude", y = "Latitude", size ="Severity at R6 stage (%)", color = "Harvest year")+
#ggtitle("Local dos ensaios")+
ggsave("figs/mapa_brazil4.png", width=13, height=8)
map <- ggplot(dat_local)+ geom_polygon(data = brazil_map2,
aes(x=long, y=lat, group=group), fill = "grey96")+
geom_jitter(alpha= 1/2, width=0.5, height=0.3, data = dat_local, aes (x = lon, y = lat, size = check_sev_r6))+
coord_fixed()+
scale_shape_manual(values = c(17,16))+
theme_light()+
facet_wrap(~year, ncol = 4)+
coord_map(xlim=-c(57.5, 43.5), ylim=-c(34,10.5))+
theme(legend.position = "top", strip.text = element_text(face="bold", size=16),text = element_text(size=16))+
#guides(shape=FALSE)+
labs(x = "Longitude", y = "Latitude", size ="Severity at R6 stage (%)", color = "Harvest year")+
#ggtitle("Local dos ensaios")+
ggsave("figs/mapa_brazil4.png", width=13, height=8)
map <- ggplot(dat_local)+ geom_polygon(data = brazil_map2,
aes(x=long, y=lat, group=group))+
geom_jitter(alpha= 1/2, width=0.5, height=0.3, data = dat_local, aes (x = lon, y = lat, size = check_sev_r6))+
coord_fixed()+
scale_shape_manual(values = c(17,16))+
theme_light()+
facet_wrap(~year, ncol = 4)+
coord_map(xlim=-c(57.5, 43.5), ylim=-c(34,10.5))+
theme(legend.position = "top", strip.text = element_text(face="bold", size=16),text = element_text(size=16))+
#guides(shape=FALSE)+
labs(x = "Longitude", y = "Latitude", size ="Severity at R6 stage (%)", color = "Harvest year")+
#ggtitle("Local dos ensaios")+
ggsave("figs/mapa_brazil4.png", width=13, height=8)
map <- ggplot(dat_local)+ geom_polygon(data = brazil_map2,
aes(x=long, y=lat, group=group), fill = "grey96", color ="grey50")+
geom_jitter(alpha= 1/2, width=0.5, height=0.3, data = dat_local, aes (x = lon, y = lat, size = check_sev_r6))+
coord_fixed()+
scale_shape_manual(values = c(17,16))+
theme_light()+
facet_wrap(~year, ncol = 4)+
coord_map(xlim=-c(57.5, 43.5), ylim=-c(34,10.5))+
theme(legend.position = "top", strip.text = element_text(face="bold", size=16),text = element_text(size=16))+
#guides(shape=FALSE)+
labs(x = "Longitude", y = "Latitude", size ="Severity at R6 stage (%)", color = "Harvest year")+
#ggtitle("Local dos ensaios")+
ggsave("figs/mapa_brazil4.png", width=13, height=8)
dat2 %>% filter(sev_r6 != "NA") %>% ggplot(aes(AI,sev_r6, fill = manc))+
geom_boxplot(outlier.size = NA)+
theme_minimal()+
geom_jitter(width = 0.1, height = 0.1, shape = 21, alpha=0.4)+
theme(axis.text.x = element_text(angle = 25, hjust = 1))+
scale_fill_grey(start = 0.5, end = 0.95)+
scale_x_discrete(labels = c("_CHECK" = "CHECK"))+
theme(legend.position = "none")+
labs(title ="", x = "", y = "Severity (%)")+
ggsave("figs/sev_AI.png", width=7, height=4)
dat2$AI <- revalue(dat2$AI, c("AACHECK" = "_CHECK"))
dat2 %>% filter(sev_r6 != "NA") %>% ggplot(aes(AI,sev_r6, fill = manc))+
geom_boxplot(outlier.size = NA)+
theme_minimal()+
geom_jitter(width = 0.1, height = 0.1, shape = 21, alpha=0.4)+
theme(axis.text.x = element_text(angle = 25, hjust = 1))+
scale_fill_grey(start = 0.5, end = 0.95)+
scale_x_discrete(labels = c("_CHECK" = "CHECK"))+
theme(legend.position = "none")+
labs(title ="", x = "", y = "Severity (%)")+
ggsave("figs/sev_AI.png", width=7, height=4)
knitr::opts_chunk$set(cache=TRUE, echo = FALSE)
# Load packages
library(tidyverse)
library(plyr)
library(readxl)
library(metafor)
library(ggthemes)
library(cowplot)
library(scales)
library(knitr)
library(nloptr)
library(minqa)
library(broom)
library(DT)
# import data
dat <- read_excel("geral_soja.xlsx", 2)
tail(dat)
head(dat)
# check structure
glimpse(dat)
kable(data.frame(table(dat$fungicide)))
length(unique(dat$study))
#filter the select fungicides
dat2 <- dat %>% group_by(study) %>% filter (fungicide == "CHECK"|
fungicide == "APROACH PRIMA"|
fungicide == "ELATUS"|
fungicide == "FOX"|
fungicide == "HOROS"|
fungicide == "OPERA"|
fungicide == "ORKESTRA"|
fungicide == "PRIORI XTRA"|
fungicide == "APROACH PRIMA+UNIZEB GOLD"|
fungicide == "ELATUS+UNIZEB GOLD"|
fungicide == "FOX+UNIZEB GOLD"|
fungicide == "HOROS+UNIZEB GOLD"|
fungicide == "OPERA+UNIZEB GOLD"|
fungicide == "ORKESTRA+UNIZEB GOLD"|
fungicide == "PRIORI XTRA+UNIZEB GOLD") %>%
#yield_kg != "NA"&
#sev_r6 != "NA"&
filter(length(study)>1)
dat2$manc <- ifelse(dat2$fungicide == "CHECK", "CHECK",
ifelse(dat2$fungicide == "APROACH PRIMA+UNIZEB GOLD","with",
ifelse(dat2$fungicide == "ELATUS+UNIZEB GOLD","with",
ifelse(dat2$fungicide =="FOX+UNIZEB GOLD","with",
ifelse(dat2$fungicide == "HOROS+UNIZEB GOLD","with",
ifelse(dat2$fungicide =="OPERA+UNIZEB GOLD","with",
ifelse(dat2$fungicide == "OPERA+UNIZEB GOLD","with",
ifelse(dat2$fungicide =="ORKESTRA+UNIZEB GOLD", "with",
ifelse(dat2$fungicide =="PRIORI XTRA+UNIZEB GOLD",
"with","without")))))))))
dat2$AI <-  revalue(dat2$AI, c("CHECK" = "AACHECK",
"PICOXISTROBINA+CIPROCONAZOLE" = "PICO + CIPR",
"PICOXISTROBINA+CIPROCONAZOLE+MANCOZEBE" = "PICO + CIPR + MANC",
"AZOXISTROBINA+BENZOVINDIFLUPYR" = "AZOX + BENZ",
"AZOXISTROBINA+BENZOVINDIFLUPYR+MANCOZEBE" = "AZOX + BENZ + MANC",
"TRIFLOXISTROBINA+PROTIOCONAZOLE" = "TFLX + PROT",
"TRIFLOXISTROBINA+PROTIOCONAZOLE+MANCOZEBE" = "TFLX + PROT + MANC",
"PICOXISTROBINA+TEBUCONAZOLE" = "PICO + TEBU",
"PICOXISTROBINA+TEBUCONAZOLE+MANCOZEBE" = "PICO + TEBU + MANC",
"PIRACLOSTROBINA+EPOXICONAZOLE" = "PIRA + EPOX",
"PIRACLOSTROBINA+EPOXICONAZOLE+MANCOZEBE" = "PIRA + EPOX + MANC",
"PIRACLOSTROBINA+FLUXAPIROXADE" = "PIRA + FLUX",
"PIRACLOSTROBINA+FLUXAPIROXADE+MANCOZEBE" = "PIRA + FLUX + MANC",
"AZOXISTROBINA+CIPROCONAZOLE" = "AZOX + CIPR",
"AZOXISTROBINA+CIPROCONAZOLE+MANCOZEBE" = "AZOX + CIPR + MANC"))
kable(data.frame(table(dat2$AI)))
#write.csv(dat2, "dat2.csv")
#openxlsx::write.xlsx(dat2, "dat_selecionados.xlsx")
knitr::opts_chunk$set(cache=TRUE, echo = FALSE)
knitr::opts_chunk$set(cache=TRUE, echo = FALSE)
# Load packages
library(tidyverse)
library(plyr)
library(readxl)
library(metafor)
library(ggthemes)
library(cowplot)
library(scales)
library(knitr)
library(nloptr)
library(minqa)
library(broom)
library(DT)
# import data
dat <- read_excel("geral_soja.xlsx", 2)
tail(dat)
head(dat)
# check structure
glimpse(dat)
kable(data.frame(table(dat$fungicide)))
length(unique(dat$study))
#filter the select fungicides
dat2 <- dat %>% group_by(study) %>% filter (fungicide == "CHECK"|
fungicide == "APROACH PRIMA"|
fungicide == "ELATUS"|
fungicide == "FOX"|
fungicide == "HOROS"|
fungicide == "OPERA"|
fungicide == "ORKESTRA"|
fungicide == "PRIORI XTRA"|
fungicide == "APROACH PRIMA+UNIZEB GOLD"|
fungicide == "ELATUS+UNIZEB GOLD"|
fungicide == "FOX+UNIZEB GOLD"|
fungicide == "HOROS+UNIZEB GOLD"|
fungicide == "OPERA+UNIZEB GOLD"|
fungicide == "ORKESTRA+UNIZEB GOLD"|
fungicide == "PRIORI XTRA+UNIZEB GOLD") %>%
#yield_kg != "NA"&
#sev_r6 != "NA"&
filter(length(study)>1)
dat2$manc <- ifelse(dat2$fungicide == "CHECK", "CHECK",
ifelse(dat2$fungicide == "APROACH PRIMA+UNIZEB GOLD","with",
ifelse(dat2$fungicide == "ELATUS+UNIZEB GOLD","with",
ifelse(dat2$fungicide =="FOX+UNIZEB GOLD","with",
ifelse(dat2$fungicide == "HOROS+UNIZEB GOLD","with",
ifelse(dat2$fungicide =="OPERA+UNIZEB GOLD","with",
ifelse(dat2$fungicide == "OPERA+UNIZEB GOLD","with",
ifelse(dat2$fungicide =="ORKESTRA+UNIZEB GOLD", "with",
ifelse(dat2$fungicide =="PRIORI XTRA+UNIZEB GOLD",
"with","without")))))))))
dat2$AI <-  revalue(dat2$AI, c("CHECK" = "AACHECK",
"PICOXISTROBINA+CIPROCONAZOLE" = "PICO + CIPR",
"PICOXISTROBINA+CIPROCONAZOLE+MANCOZEBE" = "PICO + CIPR + MANC",
"AZOXISTROBINA+BENZOVINDIFLUPYR" = "AZOX + BENZ",
"AZOXISTROBINA+BENZOVINDIFLUPYR+MANCOZEBE" = "AZOX + BENZ + MANC",
"TRIFLOXISTROBINA+PROTIOCONAZOLE" = "TFLX + PROT",
"TRIFLOXISTROBINA+PROTIOCONAZOLE+MANCOZEBE" = "TFLX + PROT + MANC",
"PICOXISTROBINA+TEBUCONAZOLE" = "PICO + TEBU",
"PICOXISTROBINA+TEBUCONAZOLE+MANCOZEBE" = "PICO + TEBU + MANC",
"PIRACLOSTROBINA+EPOXICONAZOLE" = "PIRA + EPOX",
"PIRACLOSTROBINA+EPOXICONAZOLE+MANCOZEBE" = "PIRA + EPOX + MANC",
"PIRACLOSTROBINA+FLUXAPIROXADE" = "PIRA + FLUX",
"PIRACLOSTROBINA+FLUXAPIROXADE+MANCOZEBE" = "PIRA + FLUX + MANC",
"AZOXISTROBINA+CIPROCONAZOLE" = "AZOX + CIPR",
"AZOXISTROBINA+CIPROCONAZOLE+MANCOZEBE" = "AZOX + CIPR + MANC"))
kable(data.frame(table(dat2$AI)))
#write.csv(dat2, "dat2.csv")
#openxlsx::write.xlsx(dat2, "dat_selecionados.xlsx")
dat_lat_long <- unite(dat2, local2, location, state, country, sep = " ")
dat_freq <- data.frame(table(dat2$AI, dat2$study))
dat_freq2 <- dat_freq %>%
filter(Freq > 0)
dat_freq2
kable(data.frame(table(dat_freq2$Var1)))
# import data
dat <- read_excel("geral_soja.xlsx", 2)
tail(dat)
head(dat)
# check structure
glimpse(dat)
kable(data.frame(table(dat$fungicide)))
length(unique(dat$study))
#filter the select fungicides
dat2 <- dat %>% group_by(study) %>% filter (fungicide == "CHECK"|
fungicide == "APROACH PRIMA"|
fungicide == "ELATUS"|
fungicide == "FOX"|
fungicide == "HOROS"|
fungicide == "OPERA"|
fungicide == "ORKESTRA"|
fungicide == "PRIORI XTRA"|
fungicide == "APROACH PRIMA+UNIZEB GOLD"|
fungicide == "ELATUS+UNIZEB GOLD"|
fungicide == "FOX+UNIZEB GOLD"|
fungicide == "HOROS+UNIZEB GOLD"|
fungicide == "OPERA+UNIZEB GOLD"|
fungicide == "ORKESTRA+UNIZEB GOLD"|
fungicide == "PRIORI XTRA+UNIZEB GOLD") %>%
#yield_kg != "NA"&
#sev_r6 != "NA"&
filter(length(study)>1)
dat2$manc <- ifelse(dat2$fungicide == "CHECK", "CHECK",
ifelse(dat2$fungicide == "APROACH PRIMA+UNIZEB GOLD","with",
ifelse(dat2$fungicide == "ELATUS+UNIZEB GOLD","with",
ifelse(dat2$fungicide =="FOX+UNIZEB GOLD","with",
ifelse(dat2$fungicide == "HOROS+UNIZEB GOLD","with",
ifelse(dat2$fungicide =="OPERA+UNIZEB GOLD","with",
ifelse(dat2$fungicide == "OPERA+UNIZEB GOLD","with",
ifelse(dat2$fungicide =="ORKESTRA+UNIZEB GOLD", "with",
ifelse(dat2$fungicide =="PRIORI XTRA+UNIZEB GOLD",
"with","without")))))))))
dat2$AI <-  revalue(dat2$AI, c("CHECK" = "AACHECK",
"PICOXISTROBINA+CIPROCONAZOLE" = "PICO + CIPR",
"PICOXISTROBINA+CIPROCONAZOLE+MANCOZEBE" = "PICO + CIPR + MANC",
"AZOXISTROBINA+BENZOVINDIFLUPYR" = "AZOX + BENZ",
"AZOXISTROBINA+BENZOVINDIFLUPYR+MANCOZEBE" = "AZOX + BENZ + MANC",
"TRIFLOXISTROBINA+PROTIOCONAZOLE" = "TFLX + PROT",
"TRIFLOXISTROBINA+PROTIOCONAZOLE+MANCOZEBE" = "TFLX + PROT + MANC",
"PICOXISTROBINA+TEBUCONAZOLE" = "PICO + TEBU",
"PICOXISTROBINA+TEBUCONAZOLE+MANCOZEBE" = "PICO + TEBU + MANC",
"PIRACLOSTROBINA+EPOXICONAZOLE" = "PIRA + EPOX",
"PIRACLOSTROBINA+EPOXICONAZOLE+MANCOZEBE" = "PIRA + EPOX + MANC",
"PIRACLOSTROBINA+FLUXAPIROXADE" = "PIRA + FLUX",
"PIRACLOSTROBINA+FLUXAPIROXADE+MANCOZEBE" = "PIRA + FLUX + MANC",
"AZOXISTROBINA+CIPROCONAZOLE" = "AZOX + CIPR",
"AZOXISTROBINA+CIPROCONAZOLE+MANCOZEBE" = "AZOX + CIPR + MANC"))
kable(data.frame(table(dat2$AI)))
#write.csv(dat2, "dat2.csv")
#openxlsx::write.xlsx(dat2, "dat_selecionados.xlsx")
dat_lat_long <- unite(dat2, local2, location, state, country, sep = " ")
library(ggmap)
data3 <- geocode(dat2$local2)
library(ggmap)
data3 <- geocode(dat2$local2)
View(dat_lat_long)
# import data
dat <- read_excel("geral_soja.xlsx", 2)
tail(dat)
head(dat)
# check structure
glimpse(dat)
kable(data.frame(table(dat$fungicide)))
length(unique(dat$study))
#filter the select fungicides
dat2 <- dat %>% group_by(study) %>% filter (fungicide == "CHECK"|
fungicide == "APROACH PRIMA"|
fungicide == "ELATUS"|
fungicide == "FOX"|
fungicide == "HOROS"|
fungicide == "OPERA"|
fungicide == "ORKESTRA"|
fungicide == "PRIORI XTRA"|
fungicide == "APROACH PRIMA+UNIZEB GOLD"|
fungicide == "ELATUS+UNIZEB GOLD"|
fungicide == "FOX+UNIZEB GOLD"|
fungicide == "HOROS+UNIZEB GOLD"|
fungicide == "OPERA+UNIZEB GOLD"|
fungicide == "ORKESTRA+UNIZEB GOLD"|
fungicide == "PRIORI XTRA+UNIZEB GOLD") %>%
#yield_kg != "NA"&
#sev_r6 != "NA"&
filter(length(study)>1)
dat2$manc <- ifelse(dat2$fungicide == "CHECK", "CHECK",
ifelse(dat2$fungicide == "APROACH PRIMA+UNIZEB GOLD","with",
ifelse(dat2$fungicide == "ELATUS+UNIZEB GOLD","with",
ifelse(dat2$fungicide =="FOX+UNIZEB GOLD","with",
ifelse(dat2$fungicide == "HOROS+UNIZEB GOLD","with",
ifelse(dat2$fungicide =="OPERA+UNIZEB GOLD","with",
ifelse(dat2$fungicide == "OPERA+UNIZEB GOLD","with",
ifelse(dat2$fungicide =="ORKESTRA+UNIZEB GOLD", "with",
ifelse(dat2$fungicide =="PRIORI XTRA+UNIZEB GOLD",
"with","without")))))))))
dat2$AI <-  revalue(dat2$AI, c("CHECK" = "AACHECK",
"PICOXISTROBINA+CIPROCONAZOLE" = "PICO + CIPR",
"PICOXISTROBINA+CIPROCONAZOLE+MANCOZEBE" = "PICO + CIPR + MANC",
"AZOXISTROBINA+BENZOVINDIFLUPYR" = "AZOX + BENZ",
"AZOXISTROBINA+BENZOVINDIFLUPYR+MANCOZEBE" = "AZOX + BENZ + MANC",
"TRIFLOXISTROBINA+PROTIOCONAZOLE" = "TFLX + PROT",
"TRIFLOXISTROBINA+PROTIOCONAZOLE+MANCOZEBE" = "TFLX + PROT + MANC",
"PICOXISTROBINA+TEBUCONAZOLE" = "PICO + TEBU",
"PICOXISTROBINA+TEBUCONAZOLE+MANCOZEBE" = "PICO + TEBU + MANC",
"PIRACLOSTROBINA+EPOXICONAZOLE" = "PIRA + EPOX",
"PIRACLOSTROBINA+EPOXICONAZOLE+MANCOZEBE" = "PIRA + EPOX + MANC",
"PIRACLOSTROBINA+FLUXAPIROXADE" = "PIRA + FLUX",
"PIRACLOSTROBINA+FLUXAPIROXADE+MANCOZEBE" = "PIRA + FLUX + MANC",
"AZOXISTROBINA+CIPROCONAZOLE" = "AZOX + CIPR",
"AZOXISTROBINA+CIPROCONAZOLE+MANCOZEBE" = "AZOX + CIPR + MANC"))
kable(data.frame(table(dat2$AI)))
#write.csv(dat2, "dat2.csv")
#openxlsx::write.xlsx(dat2, "dat_selecionados.xlsx")
dat_lat_long <- unite(dat2, local2, location, state, country, sep = " ")
library(ggmap)
data3 <- geocode(dat2$local2)
View(dat2)
View(dat_lat_long)
data3 <- geocode(dat_lat_long$local2)
knitr::opts_chunk$set(cache=TRUE, echo = FALSE)
# Load packages
library(tidyverse)
library(plyr)
library(readxl)
library(metafor)
library(ggthemes)
library(cowplot)
library(scales)
library(knitr)
library(nloptr)
library(minqa)
library(broom)
library(DT)
# import data
dat <- read_excel("geral_soja.xlsx", 2)
tail(dat)
head(dat)
# check structure
glimpse(dat)
kable(data.frame(table(dat$fungicide)))
length(unique(dat$study))
#filter the select fungicides
dat2 <- dat %>% group_by(study) %>% filter (fungicide == "CHECK"|
fungicide == "APROACH PRIMA"|
fungicide == "ELATUS"|
fungicide == "FOX"|
fungicide == "HOROS"|
fungicide == "OPERA"|
fungicide == "ORKESTRA"|
fungicide == "PRIORI XTRA"|
fungicide == "APROACH PRIMA+UNIZEB GOLD"|
fungicide == "ELATUS+UNIZEB GOLD"|
fungicide == "FOX+UNIZEB GOLD"|
fungicide == "HOROS+UNIZEB GOLD"|
fungicide == "OPERA+UNIZEB GOLD"|
fungicide == "ORKESTRA+UNIZEB GOLD"|
fungicide == "PRIORI XTRA+UNIZEB GOLD") %>%
#yield_kg != "NA"&
#sev_r6 != "NA"&
filter(length(study)>1)
dat2$manc <- ifelse(dat2$fungicide == "CHECK", "CHECK",
ifelse(dat2$fungicide == "APROACH PRIMA+UNIZEB GOLD","with",
ifelse(dat2$fungicide == "ELATUS+UNIZEB GOLD","with",
ifelse(dat2$fungicide =="FOX+UNIZEB GOLD","with",
ifelse(dat2$fungicide == "HOROS+UNIZEB GOLD","with",
ifelse(dat2$fungicide =="OPERA+UNIZEB GOLD","with",
ifelse(dat2$fungicide == "OPERA+UNIZEB GOLD","with",
ifelse(dat2$fungicide =="ORKESTRA+UNIZEB GOLD", "with",
ifelse(dat2$fungicide =="PRIORI XTRA+UNIZEB GOLD",
"with","without")))))))))
dat2$AI <-  revalue(dat2$AI, c("CHECK" = "AACHECK",
"PICOXISTROBINA+CIPROCONAZOLE" = "PICO + CIPR",
"PICOXISTROBINA+CIPROCONAZOLE+MANCOZEBE" = "PICO + CIPR + MANC",
"AZOXISTROBINA+BENZOVINDIFLUPYR" = "AZOX + BENZ",
"AZOXISTROBINA+BENZOVINDIFLUPYR+MANCOZEBE" = "AZOX + BENZ + MANC",
"TRIFLOXISTROBINA+PROTIOCONAZOLE" = "TFLX + PROT",
"TRIFLOXISTROBINA+PROTIOCONAZOLE+MANCOZEBE" = "TFLX + PROT + MANC",
"PICOXISTROBINA+TEBUCONAZOLE" = "PICO + TEBU",
"PICOXISTROBINA+TEBUCONAZOLE+MANCOZEBE" = "PICO + TEBU + MANC",
"PIRACLOSTROBINA+EPOXICONAZOLE" = "PIRA + EPOX",
"PIRACLOSTROBINA+EPOXICONAZOLE+MANCOZEBE" = "PIRA + EPOX + MANC",
"PIRACLOSTROBINA+FLUXAPIROXADE" = "PIRA + FLUX",
"PIRACLOSTROBINA+FLUXAPIROXADE+MANCOZEBE" = "PIRA + FLUX + MANC",
"AZOXISTROBINA+CIPROCONAZOLE" = "AZOX + CIPR",
"AZOXISTROBINA+CIPROCONAZOLE+MANCOZEBE" = "AZOX + CIPR + MANC"))
kable(data.frame(table(dat2$AI)))
#write.csv(dat2, "dat2.csv")
#openxlsx::write.xlsx(dat2, "dat_selecionados.xlsx")
dat_lat_long <- dat2 %>% filter(fungicide == "CHECK") %>% unite(dat2, local2, location, state, country, sep = " ")
dat_lat_long <- dat2 %>% filter(fungicide == "CHECK") %>% unite( local2, location, state, country, sep = " ")
View(dat_lat_long)
library(ggmap)
data3 <- geocode(dat_lat_long$local2)
data4 <- bind_cols(dat2, data3)
brazil_map <- map_data("world", "brazil")
dat_lat_long <- dat2 %>% unite( local2, location, state, country, sep = " ")
library(ggmap)
data3 <- geocode(dat_lat_long$local2)
data4 <- bind_cols(dat2, data3)
brazil_map <- map_data("world", "brazil")
library(rgdal)
brazil_map2 <-readOGR("BRA/BRA_adm1.shp", layer='BRA_adm1')
brazil_map2 <-readOGR("BRA/BRA_adm1.shp", layer='BRA_adm1')
brazil_map2 <-readOGR("BRA/BRA_adm1.shp", layer='BRA_adm1')
dat_local <- data4 %>% filter(fungicide == "CHECK", lat != "NA")
map <- ggplot(dat_local)+ geom_polygon(data = brazil_map2,
aes(x=long, y=lat, group=group), fill = "grey96", color ="grey50")+
geom_jitter(alpha= 1/2, width=0.5, height=0.3, data = dat_local, aes (x = lon, y = lat, size = check_sev_r6))+
coord_fixed()+
scale_shape_manual(values = c(17,16))+
theme_light()+
facet_wrap(~year, ncol = 4)+
coord_map(xlim=-c(57.5, 43.5), ylim=-c(34,10.5))+
theme(legend.position = "top", strip.text = element_text(face="bold", size=16),text = element_text(size=16))+
#guides(shape=FALSE)+
labs(x = "Longitude", y = "Latitude", size ="Severity at R6 stage (%)", color = "Harvest year")+
#ggtitle("Local dos ensaios")+
ggsave("figs/mapa_brazil4.png", width=13, height=8)
View(data4)
View(dat_local)
dat_lat_long <- dat2 %>% unite( local2, location, state, country, sep = " ")
library(ggmap)
#data3 <- geocode(dat_lat_long$local2)
data4 <- bind_cols(dat2, data3)
#Get world map info
brazil_map <- map_data("world", "brazil")
library(rgdal)
brazil_map2 <-readOGR("BRA/BRA_adm1.shp", layer='BRA_adm1')
dat_local <- data4 %>% filter(fungicide == "CHECK", lat != "NA")
map <- ggplot(dat_local)+ geom_polygon(data = brazil_map2,
aes(x=long, y=lat, group=group), fill = "grey96", color ="grey50")+
geom_jitter(alpha= 1/2, width=0.5, height=0.3, data = dat_local, aes (x = lon, y = lat, size = check_sev_r6))+
coord_fixed()+
scale_shape_manual(values = c(17,16))+
theme_light()+
facet_wrap(~year, ncol = 4)+
coord_map(xlim=-c(57.5, 43.5), ylim=-c(34,10.5))+
theme(legend.position = "top", strip.text = element_text(face="bold", size=16),text = element_text(size=16))+
#guides(shape=FALSE)+
labs(x = "Longitude", y = "Latitude", size ="Severity at R6 stage (%)", color = "Harvest year")+
#ggtitle("Local dos ensaios")+
ggsave("figs/mapa_brazil4.png", width=13, height=8)
View(dat_local)
View(dat_local)
